%%!TEX TS-program = latex
\documentclass[a4paper,11pt]{article}
\usepackage[utf8]{inputenc} % UTF-8
\usepackage[T1]{fontenc}
\usepackage{lmodern} % Adverteix d'un error de visualització relacionat amb [T1]{fontenc}
\usepackage[frenchb]{babel} % afrancesament
\usepackage{adjustbox}
\usepackage[fleqn]{amsmath} % alinea el mode de matemàtiques a l'esquerra
\usepackage{amssymb} % els símbols amsfont (tipus de lletra de l'American Mathematical Society)
\usepackage[table, usenames, svgnames]{xcolor} % Colors
\usepackage{multicol} % Multicolumnes
\usepackage{fancyhdr} % Disseny, capçalera i peu de pàgina
\usepackage{calc} % Operacions
\usepackage{marvosym} % símbols Martin Vogels (\EUR)
\usepackage{cancel} % dibuixa línies diagonals
\usepackage{units} % unitats tipogràfiques i fraccions
\usepackage[autolanguage]{numprint} % escriptura de comes
\usepackage{tabularx} % crea una columna de tipus paràgraf, l'amplària de la qual 
							% s'espandeix de forma automàtica 
\usepackage{wrapfig} % permet figures o tables amb text ajustats al voltant
\usepackage{pst-eucl, pst-plot} % figures geomètriques
\usepackage{enumitem}
\usepackage{interval}
\usepackage{wasysym} % Símbol de l'euro
\usepackage{mathtools} % enquadrament de l'alineació*
\usepackage[inline]{asymptote}
\usepackage{tkz-tab}
\usetikzlibrary{external} % configua l'externalització
\tikzexternalize[shell escape=-enable-write18] % activa l'externalització
\tikzset{%
  external/system call={%
    latex \tikzexternalcheckshellescape -halt-on-error
    -interaction=batchmode -jobname "\image" "\texsource" &&
    dvips -o "\image".ps "\image".dvi &&
    ps2eps -f "\image.ps"
  }
}
\intervalconfig{ separator symbol={\,;\,}}

%\usepackage{textcomp}

\usepackage[a4paper, dvips, left=1.5cm, right=1.5cm, top=2cm,%
  bottom=2cm, marginpar=5mm, marginparsep=5pt]{geometry}
\newcounter{exo}
\frenchbsetup{StandardItemLabels} % restableix \textbullet pour les listes
\setlength{\headheight}{18pt}
\setlength{\fboxsep}{5pt}
\setlength\parindent{0em}
\setlength\mathindent{0em}
\setlength{\columnsep}{30pt}
\usepackage[bookmarks=true, bookmarksnumbered=true, ps2pdf, pagebackref=true,%
            colorlinks=true,linkcolor=blue,plainpages=true,unicode]{hyperref}
\hypersetup{pdfauthor={Jérôme Ortais},pdfsubject={Exercicis de matemàtiques},pdftitle={Exercicis creats per Pyromaths, un programari lliure
    en Python sota llicència GPL}}

\def\pshlabel#1{\psframebox*[fillcolor=White,framearc=.2]{\footnotesize $#1$}}
\def\psvlabel#1{\psframebox*[fillcolor=White,framearc=.2]{\footnotesize $#1$}}

\makeatletter
\newcommand\styleexo[1][]{
  \renewcommand{\theenumi}{\arabic{enumi}}
  \renewcommand{\labelenumi}{$\blacktriangleright$\textbf{\theenumi.}}
  \renewcommand{\theenumii}{\alph{enumii}}
  \renewcommand{\labelenumii}{\textbf{\theenumii)}}
  {\fontfamily{pag}\fontseries{b}\selectfont \underline{#1 \theexo}}
  \par\@afterheading\vspace{0.5\baselineskip minus 0.2\baselineskip}}
\newcommand*\exercice{%
  \psset{unit=1cm, dash=4pt 4pt, PointName=default,linecolor=Maroon,
    dotstyle=x, linestyle=solid, hatchcolor=Peru, gridcolor=Olive,
    subgridcolor=Olive, fillcolor=Peru}
  %\ifthenelse{\equal{\theexo}{0}}{}{\filbreak}
  \refstepcounter{exo}%
  \stepcounter{nocalcul}%
  \par\addvspace{1.5\baselineskip minus 1\baselineskip}%
  \@ifstar%
  {\penalty-130\styleexo[Correcció de l'exercici]}%
  {\penalty-130\styleexo[Exercici]}%
  }
\newcommand{\checkedbox}[0]{\makebox[0pt][l]{$\square$}\raisebox{.15ex}{\hspace{0pt}$\checkmark$}}
\makeatother
\newlength{\ltxt}
\newsavebox{\mybox}
\newlength{\wdofmybox}
\newcommand{\figureadroite}[2]{%
  \setlength{\ltxt}{\linewidth}
  \sbox{\mybox}{\hbox{#1}}
  \settowidth{\wdofmybox}{\usebox{\mybox}}
  \addtolength{\ltxt}{-\wdofmybox}
  \addtolength{\ltxt}{-10pt}
  \begin{minipage}{\ltxt}
    #2
  \end{minipage}
  \hfill
  \begin{minipage}{\wdofmybox}
    #1
  \end{minipage}
}

\count1=\year \count2=\year \ifnum\month<8\advance\count1by-1\else\advance\count2by1\fi
\pagestyle{fancy}
\cfoot{\textsl{\footnotesize{Any \number\count1/\number\count2}}}
\rfoot{\textsl{\tiny{http://www.pyromaths.org}}}
\lhead{\textsl{\footnotesize{Pág. \thepage/ \pageref{LastPage}}}}
\chead{\Large{\textsc{(* if titre *)(( titre ))(* else *)Exercices(* endif *)}}}
(* if niveau *)
\rhead{\textsl{\footnotesize{(( niveau ))}}}
(* endif *)

\begin{document}
\currentpdfbookmark{Els enunciats}{Énoncés}
\newcounter{nocalcul}[exo]
\renewcommand{\thenocalcul}{\Alph{nocalcul}}
\raggedcolumns
\setlength{\columnseprule}{0.5pt}

(* if enonce *)
    (* for exo in exercices *)

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Exercice (( exo.name() ))
(( exo.tex_statement() ))
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

    (* endfor *)

\label{LastPage}
(* endif *)

(* if enonce and corrige *)
\newpage
\currentpdfbookmark{Correcció dels exercicis}{Corrigé}
\lhead{\textsl{{\footnotesize Pág. \thepage/ \pageref{LastCorPage}}}}
\setcounter{page}{1}
\setcounter{exo}{0}
(* endif *)

(* if corrige *)
    (* for exo in exercices *)

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Exercice (( exo.name() ))
(( exo.tex_answer() ))
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

    (* endfor *)

\label{LastCorPage}
(* if corrige and not enonce *)
\label{LastPage}
(* endif *)
(* endif *)

\end{document}
